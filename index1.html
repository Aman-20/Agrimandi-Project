<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriMandi Connect</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .card {
            background-color: #fff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
        }
        .form-input {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #e2e8f0;
            outline: none;
        }
        .carousel-item {
            transition: opacity 0.5s ease-in-out;
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .carousel-item.active {
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100">

    <div id="app" class="flex flex-col min-h-screen">
        <!-- Navigation -->
        <nav class="bg-white shadow-md py-4">
            <div class="container flex justify-between items-center flex-wrap">
                <div class="text-2xl font-bold text-green-700 mb-2 md:mb-0">AgriMandi Connect</div>
                <div class="flex flex-wrap space-x-2 md:space-x-4">
                    <button id="nav-home" class="text-gray-600 hover:text-green-700 font-medium">Home</button>
                    <button id="nav-mandi" class="text-gray-600 hover:text-green-700 font-medium">Mandi Prices</button>
                    <button id="nav-advisory" class="text-gray-600 hover:text-green-700 font-medium">Advisory</button>
                    <button id="nav-schemes" class="text-gray-600 hover:text-green-700 font-medium">Schemes</button>
                    <button id="nav-buyer" class="text-gray-600 hover:text-green-700 font-medium">Buyer Connect</button>
                </div>
            </div>
        </nav>

        <!-- Image Gallery (Carousel) -->
        <section id="image-carousel" class="container relative my-8 overflow-hidden rounded-xl shadow-lg" style="height: 400px;">
            <div class="carousel-item active">
                <img src="https://res.cloudinary.com/dp55vvd7j/image/upload/v1741255925/cld-sample-2.jpg" alt="Farming with modern technology" class="w-full h-full object-cover rounded-xl">
            </div>
            <div class="carousel-item">
                <img src="https://res.cloudinary.com/dp55vvd7j/image/upload/v1741255926/cld-sample-3.jpg" alt="Community of farmers during harvest" class="w-full h-full object-cover rounded-xl">
            </div>
            <div class="carousel-item">
                <img src="https://res.cloudinary.com/dp55vvd7j/image/upload/v1741255923/samples/balloons.jpg" alt="Agricultural innovation" class="w-full h-full object-cover rounded-xl">
            </div>
            <button id="prev-btn" class="absolute top-1/2 left-4 transform -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                </svg>
            </button>
            <button id="next-btn" class="absolute top-1/2 right-4 transform -translate-y-1/2 bg-white rounded-full p-2 shadow-md hover:bg-gray-100 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </button>
        </section>

        <!-- Main Content -->
        <main class="flex-grow">
            <!-- Home Page -->
            <section id="page-home" class="container py-8">
                <div class="card text-center">
                    <h1 class="text-4xl font-bold text-gray-800 mb-4">Your One-Stop Digital Mandi Portal</h1>
                    <p class="text-lg text-gray-600 mb-8">Connecting farmers with daily mandi prices, crop advisory, government schemes, and direct buyers.</p>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="p-6 bg-green-100 rounded-lg shadow-sm text-center">
                            <h3 class="font-semibold text-xl text-green-800">Mandi Prices</h3>
                            <p class="text-gray-700 mt-2">Get real-time daily prices for your crops.</p>
                        </div>
                        <div class="p-6 bg-blue-100 rounded-lg shadow-sm text-center">
                            <h3 class="font-semibold text-xl text-blue-800">Advisory</h3>
                            <p class="text-gray-700 mt-2">Seasonal and weather-based tips for better farming.</p>
                        </div>
                        <div class="p-6 bg-yellow-100 rounded-lg shadow-sm text-center">
                            <h3 class="font-semibold text-xl text-yellow-800">Schemes</h3>
                            <p class="text-gray-700 mt-2">Information on government schemes for farmers.</p>
                        </div>
                        <div class="p-6 bg-red-100 rounded-lg shadow-sm text-center">
                            <h3 class="font-semibold text-xl text-red-800">Buyer Connect</h3>
                            <p class="text-gray-700 mt-2">Directly connect with potential buyers for your produce.</p>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Latest News & Updates Section -->
            <section id="news-section" class="container py-8">
                <div class="card">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Latest Agriculture News & Updates</h2>
                    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="font-bold text-lg text-gray-800 mb-2">Government Launches New Subsidies for Drip Irrigation</h3>
                            <p class="text-gray-600 text-sm">Farmers can now avail a 50% subsidy on drip irrigation systems to promote water conservation. The scheme is available for all states...</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Read More &rarr;</a>
                        </div>
                        <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="font-bold text-lg text-gray-800 mb-2">Record-Breaking Wheat Harvest Expected This Season</h3>
                            <p class="text-gray-600 text-sm">Favorable weather conditions and timely rainfall are leading to predictions of a bumper crop. Experts advise farmers to prepare for storage...</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Read More &rarr;</a>
                        </div>
                        <div class="p-6 bg-gray-50 rounded-lg shadow-sm border border-gray-200">
                            <h3 class="font-bold text-lg text-gray-800 mb-2">New Digital Platform to Connect Farmers Directly with Exporters</h3>
                            <p class="text-gray-600 text-sm">A new government-backed portal will allow farmers to list their produce and connect directly with international buyers, cutting out middlemen...</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Read More &rarr;</a>
                        </div>
                    </div>
                </div>
            </section>


            <!-- Mandi Prices Page -->
            <section id="page-mandi" class="container py-8 hidden">
                <div class="card">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Daily Mandi Prices</h2>
                    <div class="flex flex-col md:flex-row gap-4 mb-6">
                        <div class="flex-1">
                            <label for="mandi-state" class="block text-gray-700 font-medium mb-1">State</label>
                            <select id="mandi-state" class="form-input">
                                <option value="">Select State</option>
                                <!-- <option value="Maharashtra">Maharashtra</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Uttar Pradesh">Uttar Pradesh</option> -->
                            </select>
                        </div>
                        <div class="flex-1">
                            <label for="mandi-district" class="block text-gray-700 font-medium mb-1">District</label>
                            <select id="mandi-district" class="form-input">
                                <option value="">Select District</option>
                            </select>
                        </div>
                        <div class="flex-1">
                            <label for="mandi-crop" class="block text-gray-700 font-medium mb-1">Crop</label>
                            <select id="mandi-crop" class="form-input">
                                <option value="">Select Crop</option>
                            </select>
                        </div>
                    </div>

                    <div id="mandi-table-container">
                        <table class="min-w-full bg-white border border-gray-200 rounded-lg shadow-sm">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Crop</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Today's Price (₹/Quintal)</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Average Price (₹/Quintal)</th>
                                    <th class="px-6 py-3 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Trend</th>
                                </tr>
                            </thead>
                            <tbody id="mandi-data-body" class="bg-white divide-y divide-gray-200">
                                <!-- Data will be dynamically inserted here --> 
                            </tbody>
                        </table>
                    </div>

                    <div class="mt-8">
                        <h3 class="text-xl font-semibold mb-4">Price Trend Chart</h3>
                        <div class="bg-gray-50 rounded-lg p-4">
                            <canvas id="priceChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Advisory Page -->
            <section id="page-advisory" class="container py-8 hidden">
                <div class="card">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Crop Advisory & Tips</h2>
                    <div class="space-y-6">
                        <div class="p-6 bg-green-50 rounded-lg shadow-sm border border-green-200">
                            <h3 class="font-bold text-lg text-green-800 mb-2">Monsoon Advisory</h3>
                            <p class="text-gray-700">As the monsoon season approaches, ensure proper drainage in your fields to prevent waterlogging. Use organic fertilizers to improve soil health and resilience. Monitor for common pests like aphids and stem borers, and use natural repellents.</p>
                        </div>
                        <div class="p-6 bg-blue-50 rounded-lg shadow-sm border border-blue-200">
                            <h3 class="font-bold text-lg text-blue-800 mb-2">Weather-Based Tips</h3>
                            <p class="text-gray-700">Forecast for today: Partly cloudy. Ensure your irrigation is planned for the next few days. If rainfall is expected, postpone any insecticide or herbicide application. For hot weather, consider mulching to conserve soil moisture.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Schemes Page -->
            <section id="page-schemes" class="container py-8 hidden">
                <div class="card">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Government Schemes for Farmers</h2>
                    <div class="space-y-6">
                        <div class="p-6 bg-yellow-50 rounded-lg shadow-sm border border-yellow-200">
                            <h3 class="font-bold text-lg text-yellow-800 mb-2">Pradhan Mantri Fasal Bima Yojana (PMFBY)</h3>
                            <p class="text-gray-700">A crop insurance scheme to provide financial support to farmers suffering from crop loss or damage due to unforeseen events. It covers a wide range of crops and risks.</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Learn More</a>
                        </div>
                        <div class="p-6 bg-red-50 rounded-lg shadow-sm border border-red-200">
                            <h3 class="font-bold text-lg text-red-800 mb-2">Kisan Credit Card (KCC) Scheme</h3>
                            <p class="text-gray-700">This scheme provides short-term credit to farmers. It offers flexible and simplified procedures to meet the farmers' financial needs for agricultural inputs, and post-harvest expenses.</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Learn More</a>
                        </div>
                        <div class="p-6 bg-purple-50 rounded-lg shadow-sm border border-purple-200">
                            <h3 class="font-bold text-lg text-purple-800 mb-2">National Food Security Mission (NFSM)</h3>
                            <p class="text-gray-700">A centrally sponsored scheme to increase the production of rice, wheat, pulses, coarse cereals, and commercial crops through area expansion and productivity enhancement.</p>
                            <a href="#" class="mt-4 inline-block text-blue-600 hover:underline font-semibold">Learn More</a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Buyer Connect Page -->
            <section id="page-buyer" class="container py-8 hidden">
                <div class="card">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">Connect with Buyers</h2>

                    <form id="buyer-form" class="space-y-4">
                        <div>
                            <label for="buyer-name" class="block text-gray-700 font-medium">Your Name</label>
                            <input type="text" id="buyer-name" class="form-input" required>
                        </div>
                        <div>
                            <label for="buyer-crop" class="block text-gray-700 font-medium">Crop You Need</label>
                            <input type="text" id="buyer-crop" class="form-input" required>
                        </div>
                        <div>
                            <label for="buyer-quantity" class="block text-gray-700 font-medium">Quantity (in quintals)</label>
                            <input type="number" id="buyer-quantity" class="form-input" required>
                        </div>
                        <div>
                            <label for="buyer-contact" class="block text-gray-700 font-medium">Contact Number</label>
                            <input type="tel" id="buyer-contact" class="form-input" required>
                        </div>
                        <button type="submit" class="w-full bg-green-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors">Submit Request</button>
                    </form>

                    <div class="mt-8">
                        <h3 class="text-xl font-semibold mb-4">Recent Buyer Requests</h3>
                        <div id="buyer-requests" class="space-y-4">
                            <!-- Buyer requests will be dynamically inserted here -->
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white py-8 mt-auto">
            <div class="container grid md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-xl font-bold mb-4">AgriMandi Connect</h3>
                    <p class="text-gray-400 text-sm">Empowering farmers with technology and market information.</p>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Quick Links</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-green-500">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-green-500">Services</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-green-500">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-green-500">Terms of Service</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-xl font-bold mb-4">Contact</h3>
                    <p class="text-gray-400 text-sm">Email: info@agrimandiconnect.in</p>
                    <p class="text-gray-400 text-sm">Phone: +91 98765 43210</p>
                    <p class="text-gray-400 text-sm">Address: 123 Farm Road, Rural India</p>
                </div>
            </div>
            <div class="text-center text-gray-500 text-xs mt-8">
                &copy; 2024 AgriMandi Connect. All Rights Reserved.
            </div>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const navHome = document.getElementById('nav-home');
            const navMandi = document.getElementById('nav-mandi');
            const navAdvisory = document.getElementById('nav-advisory');
            const navSchemes = document.getElementById('nav-schemes');
            const navBuyer = document.getElementById('nav-buyer');
            const pageHome = document.getElementById('page-home');
            const pageMandi = document.getElementById('page-mandi');
            const pageAdvisory = document.getElementById('page-advisory');
            const pageSchemes = document.getElementById('page-schemes');
            const pageBuyer = document.getElementById('page-buyer');
            const newsSection = document.getElementById('news-section');
            const carousel = document.getElementById('image-carousel');

            const showPage = (pageToShow) => {
                pageHome.classList.add('hidden');
                newsSection.classList.add('hidden'); // Hide news section when not on home page
                pageMandi.classList.add('hidden');
                pageAdvisory.classList.add('hidden');
                pageSchemes.classList.add('hidden');
                pageBuyer.classList.add('hidden');
                carousel.classList.add('hidden'); // Hide carousel on other pages

                if (pageToShow === pageHome) {
                    carousel.classList.remove('hidden');
                    newsSection.classList.remove('hidden');
                }
                
                pageToShow.classList.remove('hidden');
            };

            navHome.addEventListener('click', () => showPage(pageHome));
            navMandi.addEventListener('click', () => showPage(pageMandi));
            navAdvisory.addEventListener('click', () => showPage(pageAdvisory));
            navSchemes.addEventListener('click', () => showPage(pageSchemes));
            navBuyer.addEventListener('click', () => showPage(pageBuyer));

            // --- Image Carousel Logic ---
            const carouselItems = document.querySelectorAll('.carousel-item');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            let currentIndex = 0;

            const updateCarousel = () => {
                carouselItems.forEach((item, index) => {
                    if (index === currentIndex) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            };

            const nextSlide = () => {
                currentIndex = (currentIndex + 1) % carouselItems.length;
                updateCarousel();
            };

            const prevSlide = () => {
                currentIndex = (currentIndex - 1 + carouselItems.length) % carouselItems.length;
                updateCarousel();
            };

            nextBtn.addEventListener('click', nextSlide);
            prevBtn.addEventListener('click', prevSlide);

            // Auto-cycle every 5 seconds
            setInterval(nextSlide, 5000);
            updateCarousel(); // Initial call to display the first slide


            // --- Mandi Prices Page Logic ---
            const mandiState = document.getElementById('mandi-state');
            const mandiDistrict = document.getElementById('mandi-district');
            const mandiCrop = document.getElementById('mandi-crop');
            const mandiDataBody = document.getElementById('mandi-data-body');
            const priceChartCanvas = document.getElementById('priceChart');
            let priceChart = null;

            const MANDI_API_URL = '/api/mandi';
            const fetchData = async () => {
                try {
                    const response = await fetch(MANDI_API_URL);
                    if (!response.ok) throw new Error('Network response was not ok');
                    const data = await response.json();
                    
                    const states = [...new Set(data.map(item => item.state))];
                    states.forEach(state => {
                        const option = document.createElement('option');
                        option.value = state;
                        option.textContent = state;
                        mandiState.appendChild(option);
                    });

                    mandiState.addEventListener('change', () => updateFilters(data));
                    mandiDistrict.addEventListener('change', () => updateFilters(data));
                    mandiCrop.addEventListener('change', () => displayMandiData(data));
                    
                    displayMandiData(data);
                } catch (error) {
                    console.error('Failed to fetch mandi data:', error);
                }
            };

            const updateFilters = (data) => {
                const selectedState = mandiState.value;
                const selectedDistrict = mandiDistrict.value;
                const selectedCrop = mandiCrop.value;

                mandiDistrict.innerHTML = '<option value="">Select District</option>';
                mandiCrop.innerHTML = '<option value="">Select Crop</option>';
                
                let filteredData = data;
                if (selectedState) {
                    filteredData = filteredData.filter(item => item.state === selectedState);
                    const districts = [...new Set(filteredData.map(item => item.district))].sort();
                    districts.forEach(district => {
                        const option = document.createElement('option');
                        option.value = district;
                        option.textContent = district;
                        mandiDistrict.appendChild(option);
                    });
                }

                if (selectedDistrict) {
                    filteredData = filteredData.filter(item => item.district === selectedDistrict);
                }

                const crops = [...new Set(filteredData.map(item => item.crop))].sort();
                crops.forEach(crop => {
                    const option = document.createElement('option');
                    option.value = crop;
                    option.textContent = crop;
                    mandiCrop.appendChild(option);
                });

                displayMandiData(data);
            };

            const displayMandiData = (data) => {
                const selectedState = mandiState.value;
                const selectedDistrict = mandiDistrict.value;
                const selectedCrop = mandiCrop.value;
                
                let filteredData = data;
                if (selectedState) {
                    filteredData = filteredData.filter(item => item.state === selectedState);
                }
                if (selectedDistrict) {
                    filteredData = filteredData.filter(item => item.district === selectedDistrict);
                }
                if (selectedCrop) {
                    filteredData = filteredData.filter(item => item.crop === selectedCrop);
                }

                mandiDataBody.innerHTML = '';
                filteredData.forEach(item => {
                    const trend = item.todayPrice > item.yesterdayPrice ? '↑' : (item.todayPrice < item.yesterdayPrice ? '↓' : '-');
                    const trendColor = item.todayPrice > item.yesterdayPrice ? 'text-green-600' : (item.todayPrice < item.yesterdayPrice ? 'text-red-600' : 'text-gray-500');

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${item.crop}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.todayPrice}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${item.yesterdayPrice}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm ${trendColor} font-semibold">${trend}</td>
                    `;
                    mandiDataBody.appendChild(row);
                });
                
                // Update chart
                const cropsForChart = filteredData.map(item => item.crop);
                const todayPrices = filteredData.map(item => item.todayPrice);
                
                if (priceChart) {
                    priceChart.destroy();
                }

                priceChart = new Chart(priceChartCanvas, {
                    type: 'bar',
                    data: {
                        labels: cropsForChart,
                        datasets: [{
                            label: 'Today\'s Price (₹/Quintal)',
                            data: todayPrices,
                            backgroundColor: 'rgba(75, 192, 192, 0.6)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            };

            fetchData();

            // --- Buyer Connect Page Logic ---
            const buyerForm = document.getElementById('buyer-form');
            const buyerRequestsDiv = document.getElementById('buyer-requests');
            const BUYER_API_URL = '/api/buyers';

            const fetchBuyers = async () => {
                try {
                    const response = await fetch(BUYER_API_URL);
                    if (!response.ok) throw new Error('Failed to fetch buyers');
                    const buyers = await response.json();
                    displayBuyers(buyers);
                } catch (error) {
                    console.error('Error fetching buyer requests:', error);
                }
            };

            const displayBuyers = (buyers) => {
                buyerRequestsDiv.innerHTML = '';
                if (buyers.length === 0) {
                    buyerRequestsDiv.innerHTML = '<p class="text-gray-500">No buyer requests found.</p>';
                } else {
                    buyers.forEach(buyer => {
                        const buyerCard = document.createElement('div');
                        buyerCard.className = 'card bg-gray-50 border border-gray-200';
                        buyerCard.innerHTML = `
                            <h4 class="font-bold text-lg text-gray-800">${buyer.name}</h4>
                            <p class="text-gray-600 mt-2">Needs: <span class="font-medium">${buyer.crop}</span></p>
                            <p class="text-gray-600">Quantity: <span class="font-medium">${buyer.quantity} quintals</span></p>
                            <p class="text-gray-600 mt-2">Contact: <span class="font-medium text-green-600">${buyer.contact}</span></p>
                        `;
                        buyerRequestsDiv.appendChild(buyerCard);
                    });
                }
            };

            buyerForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const newBuyer = {
                    name: document.getElementById('buyer-name').value,
                    crop: document.getElementById('buyer-crop').value,
                    quantity: document.getElementById('buyer-quantity').value,
                    contact: document.getElementById('buyer-contact').value,
                };

                try {
                    const response = await fetch(BUYER_API_URL, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(newBuyer),
                    });
                    if (!response.ok) throw new Error('Failed to submit form');
                    buyerForm.reset();
                    fetchBuyers();
                    showPage(pageBuyer);
                } catch (error) {
                    console.error('Error submitting buyer request:', error);
                }
            });

            // Initial fetch of buyer data
            fetchBuyers();

        });
    </script>
</body>
</html>
